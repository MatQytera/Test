name: PostgreSQL service example
'on': push
jobs:    
  container-job:
    runs-on: ubuntu-latest
 
    container: 'node:10.18-jessie'
    services:
      postgres:
        image: postgres
        env:
          POSTGRES_PASSWORD: postgres
        options: >-
          --health-cmd pg_isready --health-interval 10s --health-timeout 5s
          --health-retries 5
          
    steps:
      - name: Update system
        run: |
          sudo apt update
          sudo apt upgrade -y 
      - name: Check out repository code
        uses: actions/checkout@v3
      - name: Install dependencies
        run: |
          npm install
          npm ci
      - name: Connect to PostgreSQL
        run: node client.js
        env:
          POSTGRES_HOST: postgres
          POSTGRES_PORT: 5432
